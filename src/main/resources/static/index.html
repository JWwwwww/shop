<!doctype html>
<html lang="en">

<head>
  <title>Title</title>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.2/css/bootstrap.min.css" integrity="sha384-Smlep5jCw/wG7hdkwQ/Z5nLIefveQRIY9nfy6xoR1uRYBtpZgI6339F5dgvm/e9B"
    crossorigin="anonymous">

  <script src="https://cdn.jsdelivr.net/npm/vue"></script>
  <script src="https://unpkg.com/axios/dist/axios.min.js"></script>

</head>

<body>
  <div id="app">
    <!-- 顶部菜单条 -->
    <nav class="navbar navbar-expand-lg navbar-light bg-light py-0 px-5">
      <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <span class="nav-link mr-auto" href="#">欢迎来到快乐购！{{user.username}}
          <a v-on:click="tui" class="text-primary" style="cursor:pointer">退出</a>
        </span>
        <ul class="navbar-nav" style="margin-right:0;">
          <li class="nav-item active">
          </li>
          <li class="nav-item">
            <a href="https://hbp1.happigo.com/csm/index.php?s=/Index" class="nav-link">合作招商</a>
          </li>
          <li class="nav-item">
            <a href="#" class="nav-link"> 400-705-1111</a>
          </li>
          <li class="nav-item">
            <a v-on:click="mys" class="nav-link">个人信息</a>
          </li>
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true"
              aria-expanded="false">
              客服中心
            </a>
            <div class="dropdown-menu" aria-labelledby="navbarDropdown">
              <a class="dropdown-item" href="http://www.happigo.com/news-43.html">帮助中心</a>
              <a class="dropdown-item" href="http://www.happigo.com/shop/index.php?act=member_feedback&amp;op=feedback_all">会员反馈</a>
            </div>
          </li>
          <li class="nav-item">
            <a v-on:click="bsm" data-toggle="modal" data-target="#bsm" class="nav-link">后台管理</a>
          </li>
        </ul>
        <div v-if="user.root==0" class="modal fade" id="bsm" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
          <div class="modal-dialog" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">你未获得管理员权限！</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </nav>
    <hr class="my-0">
    <!-- 次菜单条 -->
    <div v-if="progress!=3" class="px-5 pb-4 pt-3">
      <div class="row">
        <div class="col-lg-8 col-sm-12">
          <a href="/index">
            <img src="/images/logo.jpg" alt="">
          </a>
          <img src="/images/logo1.jpg" alt="">
        </div>
        <div class="col-lg-4 col-sm-12 mt-3">
          <form class="form-inline my-2 my-lg-0">
            <div class="row">
              <div class="input-group">
                <input v-model="pname" class="form-control" placeholder="商品/店铺">
                <div class="input-group-append">
                  <button style="background-color: #94193f;color: #fff" v-on:click="ser" type="button" class="btn btn-danger mr-2">搜索</button>
                </div>
              </div>
              <button v-on:click="shoptt" type="button" class="btn btn-warning">购物车</button>
            </div>
          </form>
        </div>
      </div>
    </div>
    <!-- 分类下拉框 -->
    <div v-if="progress!=3" style="border-bottom: 2px solid #94193f;height: 39px;line-height: 39px;">
      <div style="width: 1200px;margin: 0 auto;">
        <div class="dropdown">
          <button class="btn dropdown-toggle" style="background-color: #94193f;color: #fff;width: 159px" type="button" id="dropdownMenuButton"
            data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            全部分类
          </button>
          <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
            <a class="dropdown-item" href="#">个性护肤</a>
            <a class="dropdown-item" href="#">食品健康</a>
            <a class="dropdown-item" href="#">餐厨日用</a>
            <a class="dropdown-item" href="#">服装配饰</a>
            <a class="dropdown-item" href="#">布艺家纺</a>
            <a class="dropdown-item" href="#">家电数码</a>
          </div>
        </div>
      </div>
    </div>
    <!-- 轮播界面及商品信息 -->
    <div v-if="progress==0">
      <div id="carouselExampleIndicators" class="carousel slide" data-ride="carousel">
        <ol class="carousel-indicators">
          <li data-target="#carouselExampleIndicators" data-slide-to="0" class="active"></li>
          <li data-target="#carouselExampleIndicators" data-slide-to="1"></li>
          <li data-target="#carouselExampleIndicators" data-slide-to="2"></li>
          <li data-target="#carouselExampleIndicators" data-slide-to="3"></li>
          <li data-target="#carouselExampleIndicators" data-slide-to="4"></li>
        </ol>
        <div class="carousel-inner">
          <div class="carousel-item active">
            <img class="d-block w-100" src="/images/lunbo1.jpg" alt="First slide">
          </div>
          <div class="carousel-item">
            <img class="d-block w-100" src="/images/lunbo2.jpg" alt="Second slide">
          </div>
          <div class="carousel-item">
            <img class="d-block w-100" src="/images/lunbo6.jpg" alt="Third slide">
          </div>
          <div class="carousel-item">
            <img class="d-block w-100" src="/images/lunbo4.jpg" alt="Third slide">
          </div>
          <div class="carousel-item">
            <img class="d-block w-100" src="/images/lunbo5.jpg" alt="Third slide">
          </div>
        </div>
        <a class="carousel-control-prev" href="#carouselExampleIndicators" role="button" data-slide="prev">
          <span class="carousel-control-prev-icon" aria-hidden="true"></span>
          <span class="sr-only">Previous</span>
        </a>
        <a class="carousel-control-next" href="#carouselExampleIndicators" role="button" data-slide="next">
          <span class="carousel-control-next-icon" aria-hidden="true"></span>
          <span class="sr-only">Next</span>
        </a>
      </div>
      <br>
      <br>
      <div style="padding-left:100px;padding-right:100px">
        <h2>热卖商品</h2>
        <hr class="my-3" style="background-color: red">
        <div class="row">
          <div v-for="(product, index) in products" :key="index" class="col-lg-3 col-sm-4">
            <div v-on:click="info(product)" class="card p-3 m-3" style="width: 18rem;height: 22.5rem;">
              <img v-bind:src="product.img" style="height:250px;width:250px">
              <h5 style="color:red">￥{{product.price}}</h5>
              <h6>{{product.name}}</h6>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div v-if="progress==1" class="py-5" style="padding-left:120px;padding-right:120px">
      <div class="row">
        <div class="col-lg-4">
          <div class="card p-0" style="width: 20rem;height: 20rem;">
            <img v-bind:src="product.img" style="height:317px;width:317px">
          </div>
          <div class="mt-3" style="color: #999999;display: block;">编号：{{product.num}}</div>
        </div>
        <div class="col-lg-6">
          <h3 style="font-size: 20px;font-weight: normal;line-height: 1.2em;padding-top: 10px;overflow: hidden;">{{product.name}}</h3>
          <h6 style="font-size: 14px;color: #c41f3a;font-weight: normal;margin-top: 15px;line-height: 1.2em;overflow: hidden;">{{product.info}}</h6>
          <div style="width: 100%;background-color: #fefafb;margin-top: 10px;border-bottom: 1px dashed #f0dde1;padding-bottom: 10px;">快乐价
            <span style="font-family: arial;font-size: 42px;color: #c41f3a;">
              <em style="color: #c41f3a;font-size: 18px;font-weight: normal;"> ￥</em> {{product.price}}</span>
          </div>
          <div class="my-3 pb-3" style="border-bottom: 1px dashed #f0dde1">
            运费:
            <span class="badge badge-secondary">包邮</span>
          </div>
          <div class="my-3 pb-3" style="border-bottom: 1px dashed #f0dde1">
            剩余数量: {{product.quantity}}
          </div>
          <div class="row">
            <div class="col-lg-6">
              <button v-on:click="buy(product)" type="button" name="" id="" class="btn btn-danger btn-lg btn-block">购买</button>
            </div>
            <div class="col-lg-6">
              <button v-on:click="shopt" type="button" data-toggle="modal" data-target="#tj" class="btn btn-outline-danger btn-lg btn-block">购物车</button>
            </div>
            <div class="modal fade" id="tj" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
              <div class="modal-dialog" role="document">
                <div class="modal-content">
                  <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">添加购物车成功！</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">&times;</span>
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div v-if="progress==2">
      <div class="mt-5" style="padding-left:100px;padding-right:100px">
        <div class="row">
          <div v-for="(p, index) in pser" :key="index" class="col-lg-3 col-sm-4">
            <div v-on:click="info(p)" class="card p-3 m-3" style="width: 18rem;height: 22.5rem;">
              <img v-bind:src="p.img" style="height:250px;width:250px">
              <h5 style="color:red">￥{{p.price}}</h5>
              <h6>{{p.name}}</h6>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div v-if="progress==3">
      <div class="container mt-5">
        <div class="jumbotron py-3">
          <h2 class="display-4">个人信息</h2>
          <hr class="my-2">
          <table class="table table-hover">
            <tbody>
              <tr>
                <td scope="row">用户账号</td>
                <td>
                  {{user.id}}
                </td>
              </tr>
              <tr>
                <td scope="row">用户昵称</td>
                <td>
                  {{user.username}}
                </td>
              </tr>
              <tr>
                <td scope="row">密码</td>
                <td>
                  {{user.password}}
                </td>
              </tr>
              <tr>
                <td scope="row">性别</td>
                <td>
                  {{user.sex}}
                </td>
              </tr>
              <tr>
                <td scope="row">生日</td>
                <td>
                  {{user.date}}
                </td>
              </tr>
              <tr>
                <td scope="row">电话</td>
                <td>
                  {{user.phone}}
                </td>
              </tr>
              <tr>
                <td scope="row">收货地址1</td>
                <td>
                  {{user.address}}
                </td>
              </tr>
              <tr>
                <td scope="row">地址2</td>
                <td>
                  {{user.address1}}
                </td>
              </tr>
              <tr>
                <td scope="row">地址3</td>
                <td>
                  {{user.address2}}
                </td>
              </tr>
              <tr>
                <td colspan="2">
                  <br>
                  <div class="row">
                    <div class="col-lg-6">
                      <button type="button" class="btn btn-danger btn-lg btn-block" data-toggle="modal" data-target="#xg">修改</button>
                    </div>
                    <div class="col-lg-6">
                      <button v-on:click="fan" type="button" class="btn btn-primary btn-lg btn-block">返回</button>
                    </div>
                  </div>
                </td>
              </tr>
            </tbody>
          </table>
          <div class="modal fade" id="xg" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h5 class="modal-title" id="exampleModalLabel">修改信息</h5>
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                  </button>
                </div>
                <div class="modal-body">
                  <div class="form-group">
                    <label for="">用户名</label>
                    <input type="text" class="form-control" name="" id="" aria-describedby="helpId" placeholder="" v-model="user.username">
                  </div>
                  <div class="form-group">
                    <label for="">密码</label>
                    <input type="text" class="form-control" name="" id="" aria-describedby="helpId" placeholder="" v-model="user.password">
                  </div>
                  <div class="form-row">
                    <div class="form-group col-md-6">
                      <label for="">性别</label>
                      <input type="text" class="form-control" name="" id="" aria-describedby="helpId" placeholder="" v-model="user.sex">
                    </div>
                    <div class="form-group col-md-6">
                      <label for="">生日</label>
                      <input type="text" class="form-control" name="" id="" aria-describedby="helpId" placeholder="" v-model="user.date">
                    </div>
                  </div>
                  <div class="form-group">
                    <label for="">电话</label>
                    <input type="text" class="form-control" name="" id="" aria-describedby="helpId" placeholder="" v-model="user.phone">
                  </div>
                  <div class="form-group">
                    <label for="">地址1</label>
                    <input type="text" class="form-control" name="" id="" aria-describedby="helpId" placeholder="" v-model="user.address">
                  </div>
                  <div class="form-group">
                    <label for="">地址2</label>
                    <input type="text" class="form-control" name="" id="" aria-describedby="helpId" placeholder="" v-model="user.address1">
                  </div>
                  <div class="form-group">
                    <label for="">地址3</label>
                    <input type="text" class="form-control" name="" id="" aria-describedby="helpId" placeholder="" v-model="user.address2">
                  </div>
                </div>
                <div class="modal-footer">
                  <button type="button" class="btn btn-secondary" data-dismiss="modal">取消</button>
                  <button v-on:click="uixg" type="button" class="btn btn-primary" data-dismiss="modal">修改</button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div v-if="progress!=3">
      <img src="/images/blogo.png" style="height:auto;width:100%">
    </div>
  </div>

  <script>
    new Vue({
      el: '#app',
      data: {
        product: 0,
        products: [],
        user: 0,
        progress: 0,
        pd: [],
        pname: '',
        pser: []
      },
      methods: {
        info: function (product) {
          this.progress = 1;
          this.product = product;
        },
        shopt: function () {
          axios.post('/order', {
              product_id: this.product.id
            })
            .then((response) => {})
            .catch((error) => {})
        },
        buy: function (product) {
          product.quantity = 1;
          this.pd.push(product);
          axios.post('/js', this.pd)
            .then((response) => {
              window.location.href = "/caa"
            })
            .catch((error) => {});
        },
        shoptt: function () {
          window.location.href = "/shopts"
        },
        bsm: function () {
          if (this.user.root == 1) {
            window.location.href = "/bsm"
          }
        },
        tui: function () {
          axios.post('/tui')
            .then((response) => {
              window.location.href = "/"
            })
            .catch((error) => {})
        },
        ser: function () {
          axios.post('/ser', {
              name: this.pname
            })
            .then((response) => {
              this.pser = response.data;
              this.progress = 2
            })
            .catch((error) => {})
        },
        mys: function () {
          this.progress = 3;
        },
        fan: function () {
          window.location.href = "/index"
        },
        uixg: function () {
          axios.post('/uxg', this.user)
            .then(function (response) {})
            .catch(function (error) {})
        }
      },
      mounted: function () {
        axios.get('/product')
          .then((response) => {
            this.products = response.data;
          })
          .catch((error) => {}),
          axios.get('/getUser')
          .then((response) => {
            this.user = response.data;
          })
          .catch((error) => {})
      }
    })
  </script>

  <!-- Optional JavaScript -->
  <!-- jQuery first, then Popper.js, then Bootstrap JS -->
  <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
    crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
    crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.2/js/bootstrap.min.js" integrity="sha384-o+RDsa0aLu++PJvFqy8fFScvbHFLtbvScb8AjopnFD+iEQ7wo/CG0xlczd+2O/em"
    crossorigin="anonymous"></script>
</body>

</html>